<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>ML4AP</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/minimal.css">

		<!-- LaTeX support - Woo! -->
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<style>
			body { 
				font-variant-ligatures: none;
			}
			.container {
				display: flex;
			}
			.col {
				flex: 1;
			}
			.MJXc-display {
				font-size: 1.3em !important;
			}
		</style>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

				<!-- Title slide --->
				<section>
					<div class="top-logo">
						<img src="img/upf_red.svg" style="width: 30%;">
					</div>
					<div class="title">
						<h2 style="margin: 0px 0 0 0;">Applications of machine learning for creative and assistive audio plugins</h1>
						<!-- <h4 style="margin: 0 0 0 0;">Presentation subtitle</h4> -->
						<h5 style="margin: 5px 0 0 0;">October 10th, 2019 - Dolby Laboratories - Barcelona, Spain</h5>
						<h3 style="margin: 40px 0 0 0;"><strong>Christian Steinmetz</strong></h3>
						<h5 style="margin: 0px 0 0 0;">Music Technology Group at Universitat Pompeu Fabra</h5>
					</div>
				</section>

				<!-- Personal intro slide --->
				<section>
					<div style="float: left; text-align: left;">
						<img src="img/headshot_bw_sm.jpg" style="width: 300px;">
						<h3 style="margin: 0px 0 0 0;" ><strong> Christian Steinmetz </strong></h3>
						<h5 style="margin: 0px 0 0 0;"> <a href="christianjames.steinmetz01@estudiant.upf.edu">christianjames.steinmetz01@estudiant.upf.edu</a></h5>
						<h5 style="margin: 0px 0 0 0;"> <a href="https://christiansteinmetz.com">www.christiansteinmetz.com</a></h5>						
						<h5 style="margin: 0px 0 0 0;"> <a href="https://twitter.com/csteinmetz1">@csteinmetz1</a></h5>
					</div>
					<div style="margin-left: 60px; float:left; text-align: left; width: 50%;">

						<h4 style="margin: 0px 0 0 0;"><strong>Universitat Pompeu Fabra</strong></h4>
						<div style="margin: 10px; float:left">
							<img src="img/simbol_upf.png" style="width: 50px;">
						</div>
						<div>
							<h4 style="margin: 25px 0 0 0;">MSc in Sound and Music Computing</h4>
						</div>

						<h4 style="margin: 40px 0 0 0;"><strong>Clemson University</strong></h4>
						<div style="margin: 10px; float:left">
							<img src="img/seal_clemson.png" style="width: 50px;">
						</div>
						<div>
							<h4 style="margin: 10px 0 0 0;">BSc in Electrical Engineering</h4>
							<h4 style="margin: 0px 0 30px 0;">BA in Audio Technology</h4>
						</div>
						<h4 style="margin: 0px 0 0 0;"><strong>Internships</strong></h4>
						<div style="margin: 10px; float:left">
							<img src="img/marca_bose.jpg" style="width: 50px;">
							<br>
							<img src="img/marca_cirrus.png" style="width: 50px;">
							<br>
							<img src="img/marca_vetronix.png" style="width: 50px;">
						</div>

						<div>
							<h4 style="margin: 28px 0 35px 0;">Bose Corporation</h4>
							<h4 style="margin: 28px 0 36px 0;">Cirrus Logic, Inc.</h4>
							<h4 style="margin: 28px 0 30px 0;">Vetronix Research Corp.</h4>
						</div>							
					</div>
				</section>

				<!-- --------------- creative and assistive intro section ---------------------- --->
				<section>
					<section>
						<h2><strong>creative</strong> and <strong>assistive</strong> audio plugins</h2>
					</section>

					<!-- creative definition--->
					<section>
						<h1>creative</h1>
						<h3>expand options available to musicians and engineers</h3>
					</section>

					<!-- soundtoys --->
					<section>
						<h2 style="margin: 0;">Soundtoys suite</h2>
						<h4>( DSP ) </h4>
						<img src="img/soundtoys.jpg" style="width: 80%">						
					</section>

					<!-- vulf compressor --->
					<section>
						<h2 style="margin: 0;">Goodhertz Vulf Compressor</h2>
						<h4>( DSP ) </h4>
						<img src="img/goodhertz-vulf-comp.png" style="width: 80%">						
					</section>

					<!-- bx_panEQ --->
					<section>
						<h2 style="margin: 0;">Brainworx bx_panEQ</h2>
						<h4>( DSP ) </h4>
						<img src="img/bx-pan-eq.png" style="width: 80%">						
					</section>

					<!-- assistive definition--->
					<section>
						<h1>assistive</h1>
						<h3>lower friction in achieving desired result</h3>
					</section>

					<!-- iZotope Ozone--->
					<section>
						<h2 style="margin: 0;">iZotope Ozone</h2>
						<h4>( DSP + ML ) </h4>
						<img src="img/izotope_ozone.jpg" style="width: 80%">			
					</section>

					<!-- LANDR --->
					<section>
						<h2 style="margin: 0;">LANDR Mastering</h2>
						<h4>( DSP + ML ) </h4>
						<img src="img/landr.png" style="width: 50%">						
					</section>

					<!-- accusonus --->
					<section>
						<h2 style="margin: 0;">accusonus ERA4</h2>
						<h4>( DSP + ML ) </h4>
						<img src="img/accusonus_era4.jpg" style="width: 80%">						
					</section>

					<section>
						<h1>Relevant</h1>
						<h3>but not music production</h3>
					</section>

					<!-- Magenta Studio--->
					<section>
						<h2 style="margin: 0;">Magenta Studio</h2>
						<h4>( ML )</h4>
						<video autoplay="" loop="" muted="" playsinline="" alt="video of the different plugins in magenta studio">
							<source src="https://magenta.tensorflow.org/assets/studio/hero.mp4" type="video/mp4">
						</video>
					</section>

					<!-- Popgun Labs Splash PRO --->
					<section>
						<h2 style="margin: 0;">Popgun Labs Splash PRO</h2>
						<h4>( ML ) </h4>
						<img src="img/popgun_splash_pro.png" style="width: 30%">						
					</section>
				</section>


				<!-- My plugins intro slide --->
				<section>
					<h2>My work</h2>
					<div class="fragment fade-in" style="float:left; ">
						<img src="img/nverb_wshadow.png" style="width: 450px;">
						<h3 style="margin: 0">NeuralReverberator</h3>
						<p class="light-text">Reverb synthesis with a spectral autoencoder</p>
						<h4 class="fragment fade-in">( creative )</h4>
					</div>
					<div class="fragment fade-in" style="float: right;">
						<img src="img/flowEQ_wshadow.png" style="width: 450px;">
						<h3 style="margin: 0">flowEQ</h3>
						<p class="light-text">Smarter equalizer with β-VAE</p>
						<h4 class="fragment fade-in">( assistive) </h4>
					</div>
				</section>

				<!-- --------------- NeuralReverberator section  ------------------------- -->
				<section>
					<!-- NeuralReverberator intro slide -->
					<section>
						<h1 style="margin: 0px 0 0 0;">NeuralReverberator</h1>
						<img src="img/nverb_wshadow.png" style="width: 60%;">
					</section>

					<!-- Types of artificial reverb -->
					<section>
						<div style="float: left"> 
							<h3>Convolutional reverb</h3>
							<img src="img/hall.jpg" alt="Hall" style="width:300px;">
							<br>
							<audio controls>
								<source src=audio/hall.wav type=audio/wav>
							</audio> 
							<br>
							<audio controls>
								<source src=audio/dry.wav type=audio/wav>
							</audio> 	
							<br>
							<audio controls>
								<source src=audio/hall_gtr.wav type=audio/wav>
							</audio> 	
						</div>
						<div style="float: right;">
							<h3>Algorithmic reverb</h3>
							<img src="img/platinum_verb.png" alt="platinumVerb" style="width:300px;">
							<br>
							<img src="img/reverb_algo.gif" alt="allpass" style="width:300px;">
							<p class="light-text">Nested allpass filters</p>
						</div>
					</section>

					<!-- Model framework -->
					<section>
						<h2>Spectral autoencoder</h2>
						<img src="img/spectral_autoencoder.jpg" alt="Spectral Autoencoder" style="width:95%;">
						<h3>We create a parameterized convolutional reverb synthesizer</h3>
						<h4>(User samples from the 3 dimensional latent space)</h4>
					</section>

					<!-- How does it sound? -->
					<section>
						<h2>How does it sound?</h2>
						<div style="float:left">
							<img src="img/nverb_wshadow.png" style="width: 500px;">	
						</div>

						<div style="float:right">
							<audio controls>
								<source src=audio/dry.wav type=audio/wav>
							</audio> 
	
							<p>Dry</p>
							<audio controls>
								<source src=audio/wet2.wav type=audio/wav>
							</audio> 
	
							<p>Short reverb</p>				
							<audio controls>
								<source src=audio/wet3.wav type=audio/wav>
							</audio> 
	
							<p>Long dark reverb</p>
							<audio controls>
								<source src=audio/wet1.wav type=audio/wav>
							</audio> 
							<p>(Strange delay)</p>			       
						</div> 
					</section>

					 <!-- Dataset -->
					 <section>
						<h2>Data</h2>
						<h4>~2,000 impulse responses</h4>
						<img src="img/datasetimages.jpg" alt="Dataset images" style="width:80%;">
						<h6 style="text-align: center">Open AIR Library, Greg Hopkins, C4DM, and others</h6>
						<h4 style="text-align: center">Truncated to 2 seconds in length</h4>
						<h4 style="text-align: center">Downsampled to 16 kHz</h4>
					</section>

					 <!-- Latent space -->
					<section>
						<h2>Latent Space</h2>
						<img src="img/traverse_circle_tilt.gif" alt="latent space" style="width:95%;">  
					</section>

					 <!-- Model/training details -->
					 <section>
						<h2>Implementation details</h2>
						<ul>
							<li class="fragment fade-in">Vanilla CNN autoencoder based on NSynth baseline</li>
							<li class="fragment fade-in">Use Griffin-Lim for phase reconstruction</li>
							<li class="fragment fade-in">Model is trained on mono IRs, but we use a trick for stereo</li>
							<li class="fragment fade-in">MATLAB Audio Toolbox for implementing VST plugin</li>
							<li class="fragment fade-in">For real-time operation on CPU we subspace the latent space output</li>
						</ul>
					</section>
				</section>

				<!-- --------------- flowEQ section  ------------------------- -->
				<section>

					<!-- flowEQ intro slide -->
					<section>
						<h1 style="margin: 0px 0 0 0;">flowEQ</h1>
						<img src="img/flowEQ_wshadow.png" style="width: 60%;">
					</section>

					<!-- the Parametric Equalizer -->					
					<section>
						<img src="img/q6.png" style="max-height: 50%; max-width: 50%;">		
						<h3>Digital parametric equalizer plugin</h3>	
					</section>

					<!-- Power of the parametric EQ -->
					<section>		
						<table>
							<tr >
								<td style="border-bottom: none; vertical-align:middle;"><h3>Gain</h3></td>
								<td style="border-bottom: none;"><img src="img/gain.gif" style="max-height: 75%; max-width: 75%;"></td>
							</tr>
							<tr>
								<td style="border-bottom: none; vertical-align:middle;"><h3>Frequency</h3></td>
								<td style="border-bottom: none;"><img src="img/freq.gif" style="max-height: 75%; max-width: 75%;"></td>
							</tr>
							<tr>
								<td style="border-bottom: none; vertical-align:middle;"><h3>Q (bandwidth)</h3></td>
								<td style="border-bottom: none;"><img src="img/q.gif" style="max-height: 75%; max-width: 75%;"></td>
							</tr>
						</table>
					</section>

					<!-- Motivating example 
					<section>
						<h2>Motivating example</h2>
						<div class="fragment fade-in-then-semi-out">
							<h3>What we recorded...</h3>
							<audio controls>
								<source src="audio/pianoEQ_preEQ.mp3" type="audio/mp3">
								Your browser does not support the audio element.
							</audio>
						</div>
						<div style="margin: 25px;"></div>
						<div class="fragment fade-in-then-semi-out">
							<h3>What we want...</h3>
							<audio controls>
								<source src="audio/pianoEQ_postEQ.mp3" type="audio/mp3">
								Your browser does not support the audio element.
							</audio>
						</div>
						<div style="margin: 25px;"></div>
						<h2 class="fragment fade-in"> How do we set the EQ to get there? </h2>
					</section>
					-->

					<!-- Motivating example: Result 
					<section>
						<div>
							<h3> The parameters to achieve this are non-obvious </h3>
							<p class="fragment fade-in">(except to the well trained audio engineer)</p>
						</div>
						<img class="fragment fade-in" src="img/pianoEQ.png" style="max-height: 40%; max-width: 40%;">
					</section>
					-->

					<!-- Dataset -->
					<section>
						<h2>Dataset</h2>
						<img src="img/dataset_tf.gif" style="max-height: 30%; max-width: 30%;">	

						<h5 style="margin: 20px 0 5px 0px;"><strong>SAFE: A system for the extraction and retrieval of semantic audio descriptors</strong></h5>
						<h6>Ryan Stables, Sean Enderby. Brecht De Man, Gyorgy Fazekas, and Joshua Reiss, 2014.</h6> 
						<h5>~1700 examples</h4>			
					</section>

					<!-- Disentangled variational autoencoder -->
					<section>
						<h2>Disentangled variational autoencoder</h2>
						<div style="float: left">
							<img src="img/vae.png" style="max-height: 30%; max-width: 50%;">	
						</div>
					</section>

					<!-- How does it sound? --->
					<section>
						<h2>How does it sound?</h2>
						<div class="videoWrapper">
							<iframe width="560" height="315" src="https://www.youtube.com/embed/ws022IybkUk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
						</div>		
					</section>

					<!-- Generative decoder
					<section>
						<div class="container">
							<div style="width:60%">
								<img src="img/decoder_nosample.png" style="max-height: 90%; max-width: 90%;">
								<p class="fragment fade-in" >Select a point</p>
							</div>
							<div class="col">
								<p class="fragment fade-in" style="margin: 200px 0 0 0;">Each point decodes to EQ config</p>
								<img class="fragment fade-in" src="img/eq_curve.png" style="max-height: 80%; max-width: 80%;">		
							</div>
						</div>		
					</section>
					 -->

					<!-- Disentanglement-->
					<section>
						<h2>Disentanglement</h2>
						<div class="fragment fade-in">
							<h4> Loss function</h4>
							$$ \Large \mathcal{L}_{\beta-VAE}(\pmb{\theta},\pmb{\phi},\mathbf{x}^{(i)}) = - \mathbb{E}_{\mathbf{z} \sim q_{\theta}(\mathbf{z}|\mathbf{x}^{(i)})} [ {\log{p_\phi(\mathbf{x}^{(i)} | \mathbf{z})}} ] + \mathbf{\beta} \: D_{KL} (q_\theta(\mathbf{z} | \mathbf{x}^{(i)}) || p_\theta(\mathbf{z})) $$
						</div>

						<ul>
							<li class="fragment fade-in"><p>The beta term weighs the KL loss against the reconstruction loss</p></li>
							<li class="fragment fade-in"><p>Larger beta means greater disentanglement</p></li>
						</ul>

						<h5 style="margin: 80px 0 5px 0px;"><strong>β-VAE: Learning Basic Visual Concepts with a Constrained Variational Framework</strong></h5>
						<h6>Irina Higgins, Loic Matthey, Arka Pal, Christopher Burgess, Xavier Glorot, Matthew Botvinick, Shakir Mohamed, and Alexander Lerchner, 2017.</h6> 
					</section>

					<!-- Latent space -->
					<section data-transition="fade-in fade-out">
						<div style="float: left">
							<h2>Latent space</h2>
							<p>β = 0.000</p>
						</div>
						<img src="img/2d_manifold_200_0_000.png" style="max-height: 30%; max-width: 60%;">		
					</section>
					<section data-transition="fade-in fade-out">
						<div style="float: left">
							<h2>Latent space</h2>
							<p>β = 0.001</p>
						</div>
						<img src="img/2d_manifold_200_0_001.png" style="max-height: 30%; max-width: 60%;">
					</section>
					<section data-transition="fade-in fade-out">
						<div style="float: left">
							<h2>Latent space</h2>
							<p>β = 0.010</p>
						</div>
						<img src="img/2d_manifold_200_0_010.png" style="max-height: 30%; max-width: 60%;">
					</section>
					<section data-transition="fade-in fade-out">
						<div style="float: left">
							<h2>Latent space</h2>
							<p>β = 0.020</p>
						</div>
						<img src="img/2d_manifold_200_0_020.png" style="max-height: 30%; max-width: 60%;">	
					</section>

					<!-- Model/training details -->
					<section>
						<h2>Implementation details</h2>
						<ul>
							<li class="fragment fade-in">Train 12 different models with varying latent dim and β</li>
							<li class="fragment fade-in">Train all models for 200 epochs (about 2 hours on CPU)</li>
							<li class="fragment fade-in">MATLAB Audio Toolbox for implementing VST plugin</li>
							<li class="fragment fade-in">Network is implemented in pure MATLAB code and inference runs in real-time</li>
							<li class="fragment fade-in">User can select among these samples to adjust latent representation</li>
						</ul>
					</section>

				</section>

				<!-- ---------------  Future directions and wrap-up section  ------------------------- -->
				<section>

					<!-- What's next? -->
					<section>
						<h1>What's next?</h1>
					</section>

					<!-- End-to-end transforms -->
					<section>
						<h2>End-to-end methods for audio transformation</h2>
						<h3 class="fragment fade-in">Combine <strong>creative</strong> and <strong>assistive</strong> tools</h3>
					</section>

					<!-- End-to-end mixing -->
					<section>
						<h2>Multitrack mix enhancement</h2>
						<h4>with Wave-U-Net</h4>

						<div style="float: left;">
							<h5>Input (pre-mix)</h5>
							<audio controls>
								<source src=audio/premix.wav type=audio/wav>
							</audio> 
						</div>

						<div style="float: right;">
							<h5>Target (professional mix)</h5>
							<audio controls>
								<source src=audio/mix.wav type=audio/wav>
							</audio> 
						</div>		
					</section>

					<!-- What's been done -->
					<section>
						<h2>What's been done so far?</h2>

						<h3 class="fragment fade-in" style="text-align:left;">Audio effect modeling</h3>

						<div class="fragment fade-in" style="text-align:left;">
							<h5 style="margin: 10px 0 5px 0px;"><strong>SignalTrain: Profiling audio compressors with deep neural networks</strong></h5>
							<h6>Scott H. Hawley, Benjamin Colburn, Stylianos I. Mimilakis, May 2019</h6> 
						</div>

						<div class="fragment fade-in" style="text-align:left;">
							<h5 style="margin: 10px 0 5px 0px;"><strong>A general-purpose deep learning approach to model time-varying audio effects</strong></h5>
							<h6>Marco A. Martínez Ramírez, Emmanouil Benetos, Joshua D. Reiss, September 2019</h6> 
						</div>

						<h3 class="fragment fade-in" style="text-align:left;">Speech enhancement</h3>

						<div class="fragment fade-in" style="text-align:left;">
							<h5 style="margin: 10px 0 5px 0px;"><strong>SEGAN: Speech Enhancement Generative Adversarial Network</strong></h5>
							<h6>Santiago Pascual, Antonio Bonafonte, Joan Serrà, March 2017</h6> 
						</div>

						<div class="fragment fade-in" style="text-align:left;">
							<h5 style="margin: 10px 0 5px 0px;"><strong>A Wavenet for Speech Denoising</strong></h5>
							<h6>Dario Rethage, Jordi Pons, Xavier Serra June 2017</h6> 
						</div>

						<div class="fragment fade-in" style="text-align:left;">
							<h5 style="margin: 10px 0 5px 0px;"><strong>Improved Speech Enhancement with the Wave-U-Net</strong></h5>
							<h6>Craig Macartney, Tillman Weyde, November 2017</h6> 
						</div>


					</section>

				</section>


				<!-- Outro slide -->
				<section data-background="#c8102f">
					<div class="end">
						<img src="img/upf_wh.svg" style="width: 35%;">
						<h3 class="white" style="margin: 25px 0 0 0;"> More details on these plugins</h3>
						<h5> <a class="white" href="https://www.christiansteinmetz.com">https://www.christiansteinmetz.com</a></h5>   
						<h3 class="white" style="margin: 25px 0 0 0;"> See these slides</h3>
						<h5> <a class="white" href="https://csteinmetz1.github.io/ML4AP/">https://csteinmetz1.github.io/ML4AP</a></h5>   
						<img src="img/cs-qr-code.svg" style="float:right; margin: 50px 10px 0 0; width: 200px">
						<h4 class="white"> <img src="img/twitter_wh.png" alt="twitter" style="margin: 50px 10px 0 0; width: 30px"> @csteinmetz1</h4> 
						<h4 class="white"> <img src="img/mail_wh.png" alt="mail" style="margin: 0px 0px 0 0; width: 30px">christianjames.steinmetz01@estudiant.upf.edu</h4>
					</div>
				</section>
			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
